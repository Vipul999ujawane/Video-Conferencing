<!DOCTYPE html>
<html>
<head>
    <title>test</title>
    <script src="peer.js"></script>
    <script src="jquery-3.2.1.min.js"></script>
    <script src="//www.WebRTC-Experiment.com/RecordRTC.js"></script>
</head>
<body>
  <p>ID: </p><p id="uid"></p>
  Last Name: <input type="text" id="myText2" >
  <button onclick="myFunction2()">Call</button>

    <video id="mevideo" autoplay></video>
    <video id='oppvideo' autoplay></video>
<script>
var peer = new Peer({
    path: '/peerjs',
    host: 'localhost',
    port: 9000
});

   function Call(call) {
        call.on('stream', function (remoteStream) {
            console.log('set thier');
            //$('#call').hide();
            //$('#oppvideo').show();
            $('#oppvideo').prop('src', URL.createObjectURL(remoteStream));
            console.log('yolo');
        });
    }


peer.on('open', function(id){
  console.log('My peer ID is: ' + id);
    $('#uid').text(id);
          ;});



var constraints = {audio: true,  video: true};
navigator.mediaDevices.getUserMedia(constraints).then(function (stream) {
                window.localStream = stream;
                $('#mevideo').prop('src', URL.createObjectURL(stream));
                peer.on('call', function (call) {
                    call.answer(stream); // Answer the call with an A/V stream.
                    Call(call);
                });});

                function myFunction2() {
                var x = document.getElementById("myText2").value;
                to=x;

                var call=peer.call(to,window.localStream);
                Call(call);
                }

</script>
    <script src="jquery-3.2.1.min.js"></script>
  </body>
  </html>
